package com.oxleya.malwareconnector.file_type.enums;

import org.apache.commons.lang3.StringUtils;

public enum FileTypeEnum {

    EXCHANGE_EMAIL("msg", ""),
    JAVASCRIPT_FILE("js", "application/javascript"),
    PDF("pdf", "application/pdf");

    private final String fileExtension;
    private final String contentType;

    FileTypeEnum(String fileExtension, String contentType) {
        this.fileExtension = fileExtension;
        this.contentType = contentType;
    }

    public static FileTypeEnum getByContentType(String contentType) {
        for (FileTypeEnum fileType : FileTypeEnum.values()) {
            if (fileType.contentType.equals(contentType)) {
                return fileType;
            }
        }
        return null;
    }

    public static FileTypeEnum getByFileExtension(String fileExtension) {
        for (FileTypeEnum fileType : FileTypeEnum.values()) {
            if (fileType.getFileExtension().equals(fileExtension)) {
                return fileType;
            }
        }
        return null;
    }

    public static String getFileExtensionFromFileName(String fileName) {
        return StringUtils.substringAfterLast(fileName, ".");
    }

    public String getFileExtension() {
        return fileExtension;
    }

    public String getContentType() {
        return contentType;
    }
}
